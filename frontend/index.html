<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Ingichka Taksi</title>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>

  <!-- BACKGROUND LAYERS -->
  <div class="bg"></div>
  <div class="grain"></div>

  <!-- LOADING -->
  <div id="loading" class="loading active">
    <div class="loading-card">
      <div class="taxi-road">
        <div class="taxi-car"></div>
      </div>
      <div class="loading-text">LOADING</div>
      <div class="loading-sub">created by <b>711 GROUP</b></div>
    </div>
  </div>

  <!-- APP ROOT -->
  <div id="app" class="app">

    <!-- TOP BAR -->
    <header class="topbar">
      <div class="brand">
        <div class="brand-icon">üöï</div>
        <div class="brand-title">Ingichka Taksi</div>
      </div>
      <button class="icon-btn" onclick="openSheet('settingsSheet')" aria-label="Settings">
        ‚öôÔ∏è
      </button>
    </header>

    <!-- SCREENS -->
    <main class="screens">

      <!-- SCREEN: LANGUAGE -->
      <section id="screen-language" class="screen active">
        <div class="center-card glass">
          <h1 class="title" data-i18n="choose_lang">Tilni tanlang</h1>

          <div class="stack">
            <button class="btn primary" onclick="setLang('uz')">O‚Äòzbek</button>
            <button class="btn" onclick="setLang('ru')">–†—É—Å—Å–∫–∏–π</button>
            <button class="btn" onclick="setLang('uzk')">–ézbekcha</button>
          </div>

          <p class="muted" data-i18n="lang_hint">
            Tilni keyin sozlamalardan o‚Äòzgartirsa bo‚Äòladi.
          </p>
        </div>
      </section>

      <!-- SCREEN: ROLE -->
      <section id="screen-role" class="screen">
        <div class="center-card glass">
          <h1 class="title" data-i18n="choose_role">Rolin tanlang</h1>

          <div class="stack">
            <button class="btn primary" onclick="selectRole('driver')">
              üöò <span data-i18n="role_driver">Haydovchi</span>
            </button>

            <button class="btn" onclick="selectRole('client')">
              üë§ <span data-i18n="role_client">Mijoz</span>
            </button>
          </div>

          <button class="link" onclick="goBackTo('screen-language')">
            ‚Üê <span data-i18n="back">Orqaga</span>
          </button>
        </div>
      </section>

      <!-- SCREEN: PROFILE SETUP -->
      <section id="screen-profile" class="screen">
        <div class="sheet glass">
          <h2 class="sheet-title" data-i18n="profile_setup">Profilni to‚Äòldirish</h2>

          <div class="form-grid">

            <label class="field">
              <span data-i18n="full_name">Ism familiya</span>
              <input id="p-name" placeholder="Temur Qodirov" />
            </label>

            <label class="field">
              <span data-i18n="phone">Telefon</span>
              <input id="p-phone" placeholder="+998..." inputmode="tel" />
            </label>

            <div id="driver-extra" class="driver-extra">
              <label class="field">
                <span data-i18n="car_brand">Mashina markasi</span>
                <input id="p-car-brand" placeholder="Chevrolet Nexia" />
              </label>

              <label class="field">
                <span data-i18n="car_number">Mashina raqami</span>
                <input id="p-car-number" placeholder="01ABC123" />
              </label>
            </div>

            <!-- ‚úÖ URL PHOTO (old) -->
            <label class="field">
              <span data-i18n="photo_url">Foto (URL)</span>
              <input id="p-photo" placeholder="https://..." />
            </label>

            <!-- ‚úÖ DEVICE UPLOAD -->
            <label class="field">
              <span>Foto (Upload)</span>
              <input id="p-photo-file" type="file" accept="image/*" />
            </label>

            <label class="field">
              <span data-i18n="about_short">Qisqa info</span>
              <input id="p-bio" placeholder="..." />
            </label>
          </div>

          <div class="row">
            <button class="btn primary full" onclick="saveProfile()" data-i18n="continue">
              Davom etish
            </button>
          </div>

          <div class="row">
            <button class="link" onclick="goBackTo('screen-role')">
              ‚Üê <span data-i18n="back">Orqaga</span>
            </button>
          </div>
        </div>
      </section>

      <!-- SCREEN: HOME / FEED -->
      <section id="screen-home" class="screen">
        <div class="tabs glass">
          <button id="tabDrivers" class="tab active" onclick="switchFeed('drivers')">
            üöò <span data-i18n="drivers">Haydovchilar</span>
          </button>
          <button id="tabClients" class="tab" onclick="switchFeed('clients')">
            üë§ <span data-i18n="clients">Mijozlar</span>
          </button>
        </div>

        <div class="feed-header glass">
          <div class="feed-left">
            <div class="mini" id="geoLine">üìç <span data-i18n="geo_off">Geolokatsiya: OFF</span></div>
            <div class="mini" id="sortLine">‚ÜïÔ∏è <span data-i18n="sort_time">Saralash: vaqt</span></div>
          </div>
          <div class="feed-right">
            <button class="chip" onclick="toggleSort()"><span data-i18n="sort">Saralash</span></button>
            <button class="chip" onclick="openSheet('geoSheet')">üìç <span data-i18n="geo">Geo</span></button>
          </div>
        </div>

        <div id="cards" class="cards">
          <div class="skeleton glass"></div>
          <div class="skeleton glass"></div>
          <div class="skeleton glass"></div>
        </div>
      </section>

      <!-- SCREEN: PROFILE VIEW -->
      <section id="screen-profile-view" class="screen">
        <div class="profile glass">
          <div class="profile-top">
            <div class="avatar" id="avatar"></div>
            <div class="profile-info">
              <div class="p-name" id="pv-name">‚Äî</div>
              <div class="p-sub" id="pv-phone">‚Äî</div>
              <div class="p-sub" id="pv-car">‚Äî</div>
            </div>
          </div>

          <div class="profile-stats">
            <div class="stat glass-soft">
              <div class="stat-label" data-i18n="rating">Reyting</div>
              <div class="stat-value" id="pv-rating">0.0 ‚≠ê</div>
            </div>
            <div class="stat glass-soft">
              <div class="stat-label" data-i18n="points">Pointlar</div>
              <div class="stat-value" id="pv-points">0 üèÜ</div>
            </div>
          </div>

          <div class="profile-actions">
            <button class="btn" onclick="openSheet('editProfileSheet')" data-i18n="edit_profile">Profilni tahrirlash</button>
            <button class="btn" onclick="openSheet('myAdsSheet')" data-i18n="my_ads">Mening e‚Äôlonlarim</button>
          </div>
        </div>
      </section>

    </main>

    <!-- BOTTOM NAV -->
    <nav class="bottom glass">
      <button class="nav-btn active" id="navHome" onclick="nav('home')">
        <div class="nav-ico">üè†</div>
        <div class="nav-txt" data-i18n="nav_home">Bosh</div>
      </button>

      <button class="nav-btn" id="navCreate" onclick="openSheet('createAdSheet')">
        <div class="nav-ico big">Ôºã</div>
        <div class="nav-txt" data-i18n="nav_create">Yaratish</div>
      </button>

      <button class="nav-btn" id="navProfile" onclick="nav('profile')">
        <div class="nav-ico">üë§</div>
        <div class="nav-txt" data-i18n="nav_profile">Profil</div>
      </button>

      <button class="nav-btn" id="navSettings" onclick="openSheet('settingsSheet')">
        <div class="nav-ico">‚öôÔ∏è</div>
        <div class="nav-txt" data-i18n="nav_settings">Sozlamalar</div>
      </button>
    </nav>

  </div>

  <!-- ======= BOTTOM SHEETS ======= -->

  <!-- CREATE AD SHEET -->
  <div id="createAdSheet" class="sheet-wrap" onclick="sheetOutside(event,'createAdSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="create_ad">E‚Äôlon yaratish</div>
        <button class="icon-btn" onclick="closeSheet('createAdSheet')">‚úï</button>
      </div>

      <div class="form-grid compact">
        <div class="row2">
          <label class="field">
            <span data-i18n="point_a">TOCHKA A</span>
            <input id="ad-from" placeholder="Chirchiq" />
          </label>
          <label class="field">
            <span data-i18n="point_b">TOCHKA B</span>
            <input id="ad-to" placeholder="Sergeli" />
          </label>
        </div>

        <label class="field">
          <span data-i18n="ad_type">Tur</span>
          <select id="ad-type">
            <option value="now" data-i18n="type_now">SRAZU EDI</option>
            <option value="20" data-i18n="type_20">20 daqiqada</option>
            <option value="fill" data-i18n="type_fill">Odam to‚Äòlsa</option>
          </select>
        </label>

        <div class="row2">
          <label class="field">
            <span data-i18n="price">Narx</span>
            <input id="ad-price" placeholder="10000" inputmode="numeric" />
          </label>
          <label class="field">
            <span data-i18n="seats">Bo‚Äòsh joy</span>
            <input id="ad-seats" placeholder="3" inputmode="numeric" />
          </label>
        </div>

        <label class="field">
          <span data-i18n="comment">Izoh</span>
          <input id="ad-comment" placeholder="..." />
        </label>

        <div class="row2">
          <button class="btn primary" onclick="publishAd()" data-i18n="publish">E‚Äôlon berish</button>
          <button class="btn" onclick="closeSheet('createAdSheet')" data-i18n="close">Yopish</button>
        </div>

        <p class="muted small" data-i18n="auto_delete">
          E‚Äôlon 60 daqiqadan so‚Äòng avtomatik o‚Äòchadi.
        </p>
      </div>
    </div>
  </div>

  <!-- SETTINGS SHEET -->
  <div id="settingsSheet" class="sheet-wrap" onclick="sheetOutside(event,'settingsSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="settings">Sozlamalar</div>
        <button class="icon-btn" onclick="closeSheet('settingsSheet')">‚úï</button>
      </div>

      <div class="settings-list">
        <button class="setting-item" onclick="openSheet('langSheet')">
          üåê <span data-i18n="language">Til</span>
          <span class="right" id="langBadge">uz</span>
        </button>

        <div class="setting-item">
          üîî <span data-i18n="notifications">Bildirishnomalar</span>
          <label class="switch">
            <input id="notifyToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
        </div>

        <button class="setting-item" onclick="openSheet('donateSheet')">
          üíõ <span data-i18n="donate">Donat</span>
          <span class="right">711</span>
        </button>

        <button class="setting-item" onclick="openSheet('aboutSheet')">
          ‚ú® <span data-i18n="about">Biz haqimizda</span>
          <span class="right">i</span>
        </button>
      </div>

      <div class="sheet-foot muted small">
        created by <b>711 GROUP</b>
      </div>
    </div>
  </div>

  <!-- LANGUAGE SHEET -->
  <div id="langSheet" class="sheet-wrap" onclick="sheetOutside(event,'langSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="language">Til</div>
        <button class="icon-btn" onclick="closeSheet('langSheet')">‚úï</button>
      </div>
      <div class="stack">
        <button class="btn" onclick="setLang('uz'); closeSheet('langSheet')">O‚Äòzbek</button>
        <button class="btn" onclick="setLang('ru'); closeSheet('langSheet')">–†—É—Å—Å–∫–∏–π</button>
        <button class="btn" onclick="setLang('uzk'); closeSheet('langSheet')">–ézbekcha</button>
      </div>
    </div>
  </div>

  <!-- GEO SHEET -->
  <div id="geoSheet" class="sheet-wrap" onclick="sheetOutside(event,'geoSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title">üìç <span data-i18n="geo">Geolokatsiya</span></div>
        <button class="icon-btn" onclick="closeSheet('geoSheet')">‚úï</button>
      </div>

      <div class="setting-item">
        üìç <span data-i18n="geo_enable">Geo yoqish</span>
        <label class="switch">
          <input id="geoToggle" type="checkbox" />
          <span class="slider"></span>
        </label>
      </div>

      <div class="mini muted" id="geoStatus">‚Äî</div>

      <button class="btn" onclick="updateLocationNow()" data-i18n="geo_update">
        Joylashuvni yangilash
      </button>

      <p class="muted small" data-i18n="geo_hint">
        Geo yoqilsa, e‚Äôlonlar sizga yaqinligi bo‚Äòyicha saralanadi.
      </p>
    </div>
  </div>

  <!-- ABOUT SHEET -->
  <div id="aboutSheet" class="sheet-wrap" onclick="sheetOutside(event,'aboutSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="about">Biz haqimizda</div>
        <button class="icon-btn" onclick="closeSheet('aboutSheet')">‚úï</button>
      </div>

      <div class="about-card">
        <div class="about-shape shape1"></div>
        <div class="about-shape shape2"></div>

        <h3>Ingichka Taksi</h3>
        <p class="muted" data-i18n="about_text">
          Bu mini-ilova kichik shahar uchun: tez e‚Äôlon, tez qo‚Äòng‚Äòiroq, qulay tanlash.
        </p>

        <div class="about-pill">created by <b>711 GROUP</b></div>
      </div>
    </div>
  </div>

  <!-- DONATE SHEET -->
  <div id="donateSheet" class="sheet-wrap" onclick="sheetOutside(event,'donateSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="donate">Donat</div>
        <button class="icon-btn" onclick="closeSheet('donateSheet')">‚úï</button>
      </div>

      <div class="donate-card glass-soft">
        <h3>üíõ 711 GROUP</h3>
        <p class="muted" data-i18n="donate_text">
          Loyiha rivoji uchun qo‚Äòllab-quvvatlang. Sizning donatingiz server va yangilanishlarga ketadi.
        </p>

        <button class="btn primary full" onclick="donateNow()" data-i18n="donate_btn">
          Donat qilish
        </button>
      </div>
    </div>
  </div>

  <!-- EDIT PROFILE -->
  <div id="editProfileSheet" class="sheet-wrap" onclick="sheetOutside(event,'editProfileSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="edit_profile">Profilni tahrirlash</div>
        <button class="icon-btn" onclick="closeSheet('editProfileSheet')">‚úï</button>
      </div>

      <div class="form-grid compact">
        <label class="field">
          <span data-i18n="full_name">Ism familiya</span>
          <input id="ep-name" />
        </label>

        <label class="field">
          <span data-i18n="phone">Telefon</span>
          <input id="ep-phone" />
        </label>

        <label class="field">
          <span data-i18n="car_brand">Mashina markasi</span>
          <input id="ep-car-brand" />
        </label>

        <label class="field">
          <span data-i18n="car_number">Mashina raqami</span>
          <input id="ep-car-number" />
        </label>

        <!-- URL PHOTO -->
        <label class="field">
          <span data-i18n="photo_url">Foto (URL)</span>
          <input id="ep-photo" />
        </label>

        <!-- ‚úÖ DEVICE UPLOAD -->
        <label class="field">
          <span>Foto (Upload)</span>
          <input id="ep-photo-file" type="file" accept="image/*" />
        </label>

        <div class="row2">
          <button class="btn primary" onclick="saveProfileEdit()" data-i18n="save">Saqlash</button>
          <button class="btn" onclick="closeSheet('editProfileSheet')" data-i18n="close">Yopish</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MY ADS -->
  <div id="myAdsSheet" class="sheet-wrap" onclick="sheetOutside(event,'myAdsSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title" data-i18n="my_ads">Mening e‚Äôlonlarim</div>
        <button class="icon-btn" onclick="closeSheet('myAdsSheet')">‚úï</button>
      </div>

      <div id="myAdsList" class="cards small-cards"></div>
    </div>
  </div>

  <!-- ‚úÖ DETAIL SHEET (NEW) -->
  <div id="detailSheet" class="sheet-wrap" onclick="sheetOutside(event,'detailSheet')">
    <div class="bottom-sheet glass" onclick="event.stopPropagation()">
      <div class="sheet-head">
        <div class="sheet-head-title">üöï To‚Äòliq ma‚Äôlumot</div>
        <button class="icon-btn" onclick="closeSheet('detailSheet')">‚úï</button>
      </div>

      <div id="detailBox" class="glass-soft" style="padding:12px;border-radius:22px;"></div>
    </div>
  </div>

  <script defer src="./app.js"></script>
</body>
</html>
